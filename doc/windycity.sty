% Last modified: Fri 09 Nov 2018 04:01:53 PM CST
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{windycity}
\RequirePackage{ifxetex}

\setlength{\parindent}{1.1em}
\frenchspacing
\widowpenalty=1000
\clubpenalty=1000

\ifxetex
  \usepackage{xltxtra}
  \usepackage{xunicode}
  \usepackage{fontspec}
  \PassOptionsToPackage{unicode,xetex}{hyperref}
  \defaultfontfeatures{Ligatures=TeX,Numbers={OldStyle,Proportional},Scale=MatchLowercase}
  \setmainfont[
    Extension=.otf,
    UprightFont=*-regular,
    BoldFont=*-bold,
    ItalicFont=*-italic,
    BoldItalicFont=*-bolditalic]{texgyretermes}
  \setmonofont[
    Extension=.otf,
    UprightFont=*mono10-regular,
    ItalicFont=*mono10-italic]{lm}
  \renewcommand{\@makefnmark}{%
    \hbox{\@textsuperscript{\liningnums{\@thefnmark}}}}
\else
  \usepackage[T1]{fontenc}
  \usepackage{pifont}
  \usepackage[full]{textcomp}
  \usepackage[utf8]{inputenc}
  \usepackage{tgtermes}
  \usepackage[scaled=.90]{helvet}
  \newcommand{\liningnums}[1]{#1}%
  \renewcommand{\ttdefault}{lmtt}%
\fi

%\gdef\@email{}%
\gdef\@subtitle{}%
\gdef\@version{}%
\gdef\@website{}%
%\newcommand{\email}[1]{\gdef\@email{\mailto{#1}}}%
%\newcommand{\mailto}[1]{\href{mailto:#1}{#1}}
\newcommand{\subtitle}[1]{\gdef\@subtitle{#1}}%
\newcommand{\version}[1]{\gdef\@version{Version \liningnums{#1}}}
\newcommand{\website}[1]{\gdef\@website{\url{#1}}}%

\renewcommand\@maketitle{%
  \begin{center}%
    {\LARGE\@title}%
    \vskip 4ex%
    {\Large\@subtitle}%
    \vskip 4ex%
    {\large\@author\par\@website\par\@version\par\@date}%
  \end{center}%
  \vskip 4ex}%

\usepackage[american]{babel}
\usepackage{csquotes}
\usepackage[style=windycity]{biblatex}
\bibliography{windycity}

\renewcommand\@makefntext[1]{%
  \parindent 1em%
  \normalfont\@thefnmark.\hspace{0.4em}#1}%
\newcommand{\nfootnote}[1]{%
  \insert\footins{\normalfont\footnotesize
  \interlinepenalty\interfootnotelinepenalty
  \splittopskip\footnotesep
  \splitmaxdepth \dp\strutbox \floatingpenalty \@MM
  \hsize\columnwidth \@parboxrestore
  \footnoterule
  {\rule{\z@}{\footnotesep}\ignorespaces
    #1\strut}}}

\usepackage{tocloft}
\setcounter{tocdepth}{2}
\renewcommand{\cftbeforesecskip}{0pt}%
\renewcommand{\cftmarktoc}{\@mkboth{\contentsname}{\contentsname}}%
\renewcommand{\cftsecfont}{\normalfont}%
\renewcommand{\cftsecpagefont}{\normalfont}%

\newcounter{sh}
\renewcommand{\thesh}{Abbreviations}%
\newcounter{bib}
\renewcommand{\thebib}{Bibliography}%
\newcounter{ref}
\renewcommand{\theref}{References}%

\defbibheading{biblist}{%
  \newpage
  \begin{center}\section*{Abbreviations}\end{center}
  \addcontentsline{toc}{section}{Abbreviations}
  \markright{Abbreviations}}%
\defbibheading{bibliography}{%
  \newpage
  \begin{center}\section*{Bibliography (Standard Format)}\end{center}
  \addcontentsline{toc}{section}{Bibliography (Standard Format)}
  \markright{Bibliography}}%
\defbibheading{references}{%
  \newpage
  \begin{center}\section*{References (Author-Date Format)}\end{center}
  \addcontentsline{toc}{section}{References (Author-Date Format)}
  \markright{References}}%

\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[LO,RE]{\small\rightmark}%
\fancyhead[LE,RO]{\small\thepage}%
\renewcommand{\headrulewidth}{0pt}%
\renewcommand{\footrulewidth}{0pt}%
\renewcommand{\sectionmark}[1]{\markright{\thesection.\ #1}}%
\renewcommand{\subsectionmark}[1]{\markright{\thesubsection\ #1}}%

\renewcommand*{\@seccntformat}[1]{%
  \csname the#1\endcsname
  \csname adddot@#1\endcsname\quad}%
\newcommand*{\adddot@section}{.}%
\renewcommand\thesubsubsection{%
  \normalfont\arabic{subsection}.\@arabic\c@subsubsection}

\renewcommand\section{\@startsection{section}{1}{\z@}%
  {-3.5ex \@plus -1ex \@minus -.2ex}%
  {2.3ex \@plus.2ex}%
  {\normalfont\large\bfseries}}
\renewcommand\subsection{\@startsection{subsection}{2}{\z@}%
  {-3.5ex\@plus -1ex \@minus -.2ex}%
  {1.5ex \@plus .2ex}%
  {\normalfont\bfseries}}%
\renewcommand\subsubsection{\@startsection{subsubsection}{3}{\z@}%
  {-4ex\@plus -1ex \@minus -.2ex}%
  {1.5ex \@plus .2ex}%
  {\normalfont\it}}

\usepackage{ragged2e}
\usepackage{calc}% for \setlist[itemize] below
\usepackage{enumitem}
\setlist[enumerate]{noitemsep}
\setlist[itemize]{%
  before=\RaggedRight,
  itemsep=3pt,
  labelsep=1.75em,
  labelwidth=\widthof{N},
  leftmargin={\labelwidth+\labelsep},
  parsep=4pt}

\newcommand{\biber}{%
  \href{http://www.ctan.org/tex-archive/biblio/biber}{\texttt{biber}}\xspace}%
\newcommand{\biblatex}{%
  \href{http://www.ctan.org/pkg/biblatex}{\texttt{biblatex}}\xspace}%
% From Oren Patashnik's documentation for bibtex:
\newcommand{\BibTeX}{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
  T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}%

\usepackage[
  anchorcolor=black,
  breaklinks=true,
  citecolor=black,
  colorlinks=true,
  linkcolor=black,
  pdfauthor={Brian Michael Chase},
  pdftitle={Windy City for biblatex},
  urlcolor=black]{hyperref}
\urlstyle{rm}
\usepackage{btxdockit}% for \bibfield, \bibtype, \cmd, marglist
\lstset{basicstyle=\small\ttfamily}
\pretocmd{\bibfield}{\sloppy}{}{}
\pretocmd{\bibtype}{\sloppy}{}{}
\pretocmd{\cmd}{\sloppy}{}{}

\endinput
